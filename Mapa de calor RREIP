<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Trativas de Circuitos com Análise de Falhas</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <style>
    body { padding: 30px; background-color: #f8f9fa; font-family: Arial, sans-serif; }
    h1 { margin-bottom: 30px; color: #007bff; }
    .table-container { margin-top: 40px; border: 1px solid #dee2e6; border-radius: 5px; padding: 20px; background-color: #ffffff; }
  </style>
</head>
<body>
  <div class="container">
    <h1>Trativas de Circuitos com Análise de Falhas</h1>

    <form id="importForm" class="mb-4" enctype="multipart/form-data">
      <div class="mb-3">
        <label for="file" class="form-label">Importar Base de Dados (CSV):</label>
        <input class="form-control" type="file" name="file" id="file" accept=".csv" required>
      </div>
      <button class="btn btn-primary" type="submit">Importar e Analisar</button>
    </form>

    <div class="table-container">
      <h3>Resultados da Análise de Falhas</h3>
      <table class="table table-striped" id="tabelaResultados">
        <thead>
          <tr>
            <th>Circuito</th>
            <th>Data</th>
            <th>Descrição da Falha</th>
            <th>Plano de Ação</th>
          </tr>
        </thead>
        <tbody>
          <!-- Os resultados da análise serão inseridos aqui -->
        </tbody>
      </table>
    </div>
  </div>

  <script>
    document.getElementById('importForm').addEventListener('submit', function(event) {
      event.preventDefault(); // Impede o envio do formulário

      const fileInput = document.getElementById('file');
      const file = fileInput.files[0];

      if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
          const contents = e.target.result;
          processCSV(contents);
        };
        reader.readAsText(file);
      }
    });

    function processCSV(data) {
      const rows = data.split('\n');
      const tabelaResultados = document.getElementById('tabelaResultados').getElementsByTagName('tbody')[0];
      tabelaResultados.innerHTML = ''; // Limpa a tabela antes de adicionar novos dados

      rows.forEach((row, index) => {
        if (index === 0) return; // Ignora o cabeçalho do CSV
        const columns = row.split(',');

        if (columns.length >= 4) {
          const circuito = columns[0].trim();
          const data = columns[1].trim();
          const descricao = columns[2].trim();
          const acao = columns[3].trim();

          // Adiciona uma nova linha na tabela de resultados
          const novaLinha = tabelaResultados.insertRow();
          novaLinha.insertCell(0).textContent = circuito;
          novaLinha.insertCell(1).textContent = data;
          novaLinha.insertCell(2).textContent = descricao;
          novaLinha.insertCell(3).textContent = acao;
        }
      });
    }
  </script>
</body>
</html>
